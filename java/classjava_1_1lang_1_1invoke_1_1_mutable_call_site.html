<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>openjdk8_analysis: java.lang.invoke.MutableCallSite Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">openjdk8_analysis
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacejava.html">java</a></li><li class="navelem"><a class="el" href="namespacejava_1_1lang.html">lang</a></li><li class="navelem"><a class="el" href="namespacejava_1_1lang_1_1invoke.html">invoke</a></li><li class="navelem"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html">MutableCallSite</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">java.lang.invoke.MutableCallSite Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for java.lang.invoke.MutableCallSite:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site__inherit__graph.png" border="0" usemap="#java_8lang_8invoke_8_mutable_call_site_inherit__map" alt="Inheritance graph"/></div>
<map name="java_8lang_8invoke_8_mutable_call_site_inherit__map" id="java_8lang_8invoke_8_mutable_call_site_inherit__map">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_call_site.html" title="java.lang.invoke.CallSite" alt="" coords="6,5,167,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for java.lang.invoke.MutableCallSite:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site__coll__graph.png" border="0" usemap="#java_8lang_8invoke_8_mutable_call_site_coll__map" alt="Collaboration graph"/></div>
<map name="java_8lang_8invoke_8_mutable_call_site_coll__map" id="java_8lang_8invoke_8_mutable_call_site_coll__map">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_call_site.html" title="java.lang.invoke.CallSite" alt="" coords="1181,17,1343,43"/>
<area shape="rect" id="node3" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html" title="java.lang.invoke.MethodHandle" alt="" coords="825,97,1024,123"/>
<area shape="rect" id="node5" href="classjava_1_1lang_1_1_object.html" title="java.lang.Object" alt="" coords="1205,173,1319,199"/>
<area shape="rect" id="node7" href="interfacejava_1_1lang_1_1reflect_1_1_member.html" title="java.lang.reflect.Member" alt="" coords="456,351,619,378"/>
<area shape="rect" id="node8" href="interfacejava_1_1lang_1_1_cloneable.html" title="java.lang.Cloneable" alt="" coords="471,402,604,429"/>
<area shape="rect" id="node9" href="classjava_1_1lang_1_1_string.html" title="java.lang.String" alt="" coords="482,461,593,487"/>
<area shape="rect" id="node10" href="interfacejava_1_1io_1_1_serializable.html" title="java.io.Serializable" alt="" coords="46,366,175,393"/>
<area shape="rect" id="node16" href="classjava_1_1lang_1_1invoke_1_1_method_type.html" title="java.lang.invoke.MethodType" alt="" coords="444,301,631,327"/>
<area shape="rect" id="node11" href="interfacejava_1_1lang_1_1_comparable.html" title="java.lang.Comparable\l\&lt; String \&gt;" alt="" coords="38,417,183,459"/>
<area shape="rect" id="node12" href="interfacejava_1_1lang_1_1_char_sequence.html" title="java.lang.CharSequence" alt="" coords="30,483,191,510"/>
<area shape="rect" id="node13" href="interfacejava_1_1util_1_1_comparator.html" title="java.util.Comparator\l\&lt; java.lang.String \&gt;" alt="" coords="43,535,179,576"/>
<area shape="rect" id="node18" href="classjava_1_1lang_1_1_class.html" title="java.lang.Class\&lt;?\&gt;" alt="" coords="45,235,177,262"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af60b01b063faeb6a52562aff92b9b5b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> (<a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_type.html">MethodType</a> <a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#ac8d05a69dfddad40bbb02ea1abd0ea3e">type</a>)</td></tr>
<tr class="separator:af60b01b063faeb6a52562aff92b9b5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95245fe8420cc7e03333690568198ef5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a95245fe8420cc7e03333690568198ef5">MutableCallSite</a> (<a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a> target)</td></tr>
<tr class="separator:a95245fe8420cc7e03333690568198ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230cbbd86c5d49b82022da30be5ae21b"><td class="memItemLeft" align="right" valign="top">final <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a230cbbd86c5d49b82022da30be5ae21b">getTarget</a> ()</td></tr>
<tr class="separator:a230cbbd86c5d49b82022da30be5ae21b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f79b52827cd47d161890fd7bf94dcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af0f79b52827cd47d161890fd7bf94dcb">setTarget</a> (<a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a> newTarget)</td></tr>
<tr class="separator:af0f79b52827cd47d161890fd7bf94dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447eedb899a588432264f9d8b2aba791"><td class="memItemLeft" align="right" valign="top">final <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a447eedb899a588432264f9d8b2aba791">dynamicInvoker</a> ()</td></tr>
<tr class="separator:a447eedb899a588432264f9d8b2aba791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html">java.lang.invoke.CallSite</a></td></tr>
<tr class="memitem:ac8d05a69dfddad40bbb02ea1abd0ea3e inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_type.html">MethodType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#ac8d05a69dfddad40bbb02ea1abd0ea3e">type</a> ()</td></tr>
<tr class="separator:ac8d05a69dfddad40bbb02ea1abd0ea3e inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2df3ef244c79cebb4b1834826aa88b inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memItemLeft" align="right" valign="top">abstract <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#aed2df3ef244c79cebb4b1834826aa88b">getTarget</a> ()</td></tr>
<tr class="separator:aed2df3ef244c79cebb4b1834826aa88b inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a6d95b55b3e5c91cded0d933569451 inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memItemLeft" align="right" valign="top">abstract void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#a94a6d95b55b3e5c91cded0d933569451">setTarget</a> (<a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a> newTarget)</td></tr>
<tr class="separator:a94a6d95b55b3e5c91cded0d933569451 inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226b44afcef089aaff78857f6af43615 inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memItemLeft" align="right" valign="top">abstract <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#a226b44afcef089aaff78857f6af43615">dynamicInvoker</a> ()</td></tr>
<tr class="separator:a226b44afcef089aaff78857f6af43615 inherit pub_methods_classjava_1_1lang_1_1invoke_1_1_call_site"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a691573d27e1e864b1d15f61a6a9a7f33"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> (<a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html">MutableCallSite</a>[] sites)</td></tr>
<tr class="separator:a691573d27e1e864b1d15f61a6a9a7f33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> </div></div><!-- fragment --><p> is a <a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html">CallSite</a> whose target variable behaves like an ordinary field. An</p><div class="fragment"><div class="line">invokedynamic </div></div><!-- fragment --><p> instruction linked to a</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> </div></div><!-- fragment --><p> delegates all calls to the site's current target. The  <a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#a226b44afcef089aaff78857f6af43615">CallSite::dynamicInvoker</a> dynamic invoker} of a mutable call site also delegates each call to the site's current target. </p>
<p>Here is an example of a mutable call site which introduces a state variable into a method handle chain.</p>
<blockquote class="doxtable">
<pre><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> name = <span class="keyword">new</span> <a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a>(MethodType.methodType(String.class));</div><div class="line">MethodHandle MH_name = name.dynamicInvoker();</div><div class="line">MethodType MT_str1 = MethodType.methodType(String.class);</div><div class="line">MethodHandle MH_upcase = MethodHandles.lookup()</div><div class="line">    .findVirtual(String.class, <span class="stringliteral">&quot;toUpperCase&quot;</span>, MT_str1);</div><div class="line">MethodHandle worker1 = MethodHandles.filterReturnValue(MH_name, MH_upcase);</div><div class="line">name.setTarget(MethodHandles.constant(String.class, <span class="stringliteral">&quot;Rocky&quot;</span>));</div><div class="line">assertEquals(<span class="stringliteral">&quot;ROCKY&quot;</span>, (String) worker1.invokeExact());</div><div class="line">name.setTarget(MethodHandles.constant(String.class, <span class="stringliteral">&quot;Fred&quot;</span>));</div><div class="line">assertEquals(<span class="stringliteral">&quot;FRED&quot;</span>, (String) worker1.invokeExact());</div><div class="line"><span class="comment">// (mutation can be continued indefinitely)</span></div></div><!-- fragment --> </pre></blockquote>
<p>The same call site may be used in several places at once. </p><blockquote class="doxtable">
<pre><div class="fragment"><div class="line">MethodType MT_str2 = MethodType.methodType(String.class, String.class);</div><div class="line">MethodHandle MH_cat = lookup().findVirtual(String.class,</div><div class="line">  <span class="stringliteral">&quot;concat&quot;</span>, methodType(String.class, String.class));</div><div class="line">MethodHandle MH_dear = MethodHandles.insertArguments(MH_cat, 1, <span class="stringliteral">&quot;, dear?&quot;</span>);</div><div class="line">MethodHandle worker2 = MethodHandles.filterReturnValue(MH_name, MH_dear);</div><div class="line">assertEquals(<span class="stringliteral">&quot;Fred, dear?&quot;</span>, (String) worker2.invokeExact());</div><div class="line">name.setTarget(MethodHandles.constant(String.class, <span class="stringliteral">&quot;Wilma&quot;</span>));</div><div class="line">assertEquals(<span class="stringliteral">&quot;WILMA&quot;</span>, (String) worker1.invokeExact());</div><div class="line">assertEquals(<span class="stringliteral">&quot;Wilma, dear?&quot;</span>, (String) worker2.invokeExact());</div></div><!-- fragment --> </pre></blockquote>
<p><em>Non-synchronization of target values:</em> A write to a mutable call site's target does not force other threads to become aware of the updated value. Threads which do not perform suitable synchronization actions relative to the updated call site may cache the old target value and delay their use of the new target value indefinitely. (This is a normal consequence of the Java Memory Model as applied to object fields.) </p>
<p>The <a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> operation provides a way to force threads to accept a new target value, even if there is no other synchronization. </p>
<p>For target values which will be frequently updated, consider using a  <a class="el" href="classjava_1_1lang_1_1invoke_1_1_volatile_call_site.html">VolatileCallSite</a> volatile call site} instead. </p><dl class="section author"><dt>Author</dt><dd>John Rose, JSR 292 EG </dd></dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00084">84</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af60b01b063faeb6a52562aff92b9b5b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">java.lang.invoke.MutableCallSite.MutableCallSite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_type.html">MethodType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a blank call site object with the given method type. The initial target is set to a method handle of the given type which will throw an <a class="el" href="">IllegalStateException</a> if called. </p>
<p>The type of the call site is permanently set to the given type. </p>
<p>Before this</p><div class="fragment"><div class="line">CallSite </div></div><!-- fragment --><p> object is returned from a bootstrap method, or invoked in some other manner, it is usually provided with a more useful target method, via a call to <a class="el" href="classjava_1_1lang_1_1invoke_1_1_call_site.html#a94a6d95b55b3e5c91cded0d933569451">setTarget</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>the method type that this call site will have </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classjava_1_1lang_1_1_null_pointer_exception.html">NullPointerException</a></td><td>if the proposed type is null </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00099">99</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

</div>
</div>
<a class="anchor" id="a95245fe8420cc7e03333690568198ef5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">java.lang.invoke.MutableCallSite.MutableCallSite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a call site object with an initial target method handle. The type of the call site is permanently set to the initial target's type. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>the method handle that will be the initial target of the call site </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classjava_1_1lang_1_1_null_pointer_exception.html">NullPointerException</a></td><td>if the proposed target is null </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00109">109</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a447eedb899a588432264f9d8b2aba791"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a> java.lang.invoke.MutableCallSite.dynamicInvoker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00161">161</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a447eedb899a588432264f9d8b2aba791_icgraph.png" border="0" usemap="#classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a447eedb899a588432264f9d8b2aba791_icgraph" alt=""/></div>
<map name="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a447eedb899a588432264f9d8b2aba791_icgraph" id="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a447eedb899a588432264f9d8b2aba791_icgraph">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_switch_point.html#a9409ec66f8b8b2029d546c5a37ab77e7" title="java.lang.invoke.SwitchPoint.\lSwitchPoint" alt="" coords="216,5,405,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a230cbbd86c5d49b82022da30be5ae21b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final <a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a> java.lang.invoke.MutableCallSite.getTarget </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the target method of the call site, which behaves like a normal field of the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> </div></div><!-- fragment --><p> . </p>
<p>The interactions of</p><div class="fragment"><div class="line">getTarget </div></div><!-- fragment --><p> with memory are the same as of a read from an ordinary variable, such as an array element or a non-volatile, non-final field. </p>
<p>In particular, the current thread may choose to reuse the result of a previous read of the target from memory, and may fail to see a recent update to the target by another thread.</p>
<dl class="section return"><dt>Returns</dt><dd>the linkage state of this call site, a method handle which can change over time </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af0f79b52827cd47d161890fd7bf94dcb">setTarget</a> </dd></dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00128">128</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a230cbbd86c5d49b82022da30be5ae21b_icgraph.png" border="0" usemap="#classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a230cbbd86c5d49b82022da30be5ae21b_icgraph" alt=""/></div>
<map name="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a230cbbd86c5d49b82022da30be5ae21b_icgraph" id="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a230cbbd86c5d49b82022da30be5ae21b_icgraph">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_switch_point.html#ac9d017841e04766ecbf277f9374d9e8d" title="java.lang.invoke.SwitchPoint.has\lBeenInvalidated" alt="" coords="221,5,432,47"/>
<area shape="rect" id="node3" href="classjava_1_1lang_1_1invoke_1_1_switch_point.html#aaa293979c594b1730ef12b5c732c9fa7" title="java.lang.invoke.SwitchPoint.guard\lWithTest" alt="" coords="216,71,437,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af0f79b52827cd47d161890fd7bf94dcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void java.lang.invoke.MutableCallSite.setTarget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_method_handle.html">MethodHandle</a>&#160;</td>
          <td class="paramname"><em>newTarget</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the target method of this call site, as a normal variable. The type of the new target must agree with the type of the old target. </p>
<p>The interactions with memory are the same as of a write to an ordinary variable, such as an array element or a non-volatile, non-final field. </p>
<p>In particular, unrelated threads may fail to see the updated target until they perform a read from memory. Stronger guarantees can be created by putting appropriate operations into the bootstrap method and/or the target methods used at any given call site.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newTarget</td><td>the new target </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classjava_1_1lang_1_1_null_pointer_exception.html">NullPointerException</a></td><td>if the proposed new target is null </td></tr>
    <tr><td class="paramname"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_wrong_method_type_exception.html">WrongMethodTypeException</a></td><td>if the proposed new target has a method type that differs from the previous target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a230cbbd86c5d49b82022da30be5ae21b">getTarget</a> </dd></dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00152">152</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_af0f79b52827cd47d161890fd7bf94dcb_icgraph.png" border="0" usemap="#classjava_1_1lang_1_1invoke_1_1_mutable_call_site_af0f79b52827cd47d161890fd7bf94dcb_icgraph" alt=""/></div>
<map name="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_af0f79b52827cd47d161890fd7bf94dcb_icgraph" id="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_af0f79b52827cd47d161890fd7bf94dcb_icgraph">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_switch_point.html#a9e688bed3122c0dbbfe5e81691de2eb8" title="java.lang.invoke.SwitchPoint.invalidateAll" alt="" coords="216,13,473,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a691573d27e1e864b1d15f61a6a9a7f33"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void java.lang.invoke.MutableCallSite.syncAll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html">MutableCallSite</a>[]&#160;</td>
          <td class="paramname"><em>sites</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs a synchronization operation on each call site in the given array, forcing all other threads to throw away any cached values previously loaded from the target of any of the call sites. </p>
<p>This operation does not reverse any calls that have already started on an old target value. (Java supports  <a class="el" href="classjava_1_1lang_1_1_object.html#a23378a211506386eec5fa6dd037beb93">java.lang.Object::wait()</a> forward time travel} only.) </p>
<p>The overall effect is to force all future readers of each call site's target to accept the most recently stored value. ("Most recently" is reckoned relative to the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> itself.) Conversely, the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> call may block until all readers have (somehow) decached all previous versions of each call site's target. </p>
<p>To avoid race conditions, calls to</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af0f79b52827cd47d161890fd7bf94dcb">setTarget</a> </div></div><!-- fragment --><p> and</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> should generally be performed under some sort of mutual exclusion. Note that reader threads may observe an updated target as early as the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af0f79b52827cd47d161890fd7bf94dcb">setTarget</a> </div></div><!-- fragment --><p> call that install the value (and before the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> that confirms the value). On the other hand, reader threads may observe previous versions of the target until the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> call returns (and after the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af0f79b52827cd47d161890fd7bf94dcb">setTarget</a> </div></div><!-- fragment --><p> that attempts to convey the updated version). </p>
<p>This operation is likely to be expensive and should be used sparingly. If possible, it should be buffered for batch processing on sets of call sites. </p>
<p>If</p><div class="fragment"><div class="line">sites </div></div><!-- fragment --><p> contains a null element, a</p><div class="fragment"><div class="line">NullPointerException </div></div><!-- fragment --><p> will be raised. In this case, some non-null elements in the array may be processed before the method returns abnormally. Which elements these are (if any) is implementation-dependent.</p>
<h1>Java Memory Model details</h1>
<p>In terms of the Java Memory Model, this operation performs a synchronization action which is comparable in effect to the writing of a volatile variable by the current thread, and an eventual volatile read by every other thread that may access one of the affected call sites. </p>
<p>The following effects are apparent, for each individual call site</p><div class="fragment"><div class="line">S </div></div><!-- fragment --><p> : </p><ul>
<li>
A new volatile variable<div class="fragment"><div class="line">V </div></div><!-- fragment --> is created, and written by the current thread. As defined by the JMM, this write is a global synchronization event. </li>
<li>
As is normal with thread-local ordering of write events, every action already performed by the current thread is taken to happen before the volatile write to<div class="fragment"><div class="line">V </div></div><!-- fragment --> . (In some implementations, this means that the current thread performs a global release operation.) </li>
<li>
Specifically, the write to the current target of<div class="fragment"><div class="line">S </div></div><!-- fragment --> is taken to happen before the volatile write to<div class="fragment"><div class="line">V </div></div><!-- fragment --> . </li>
<li>
The volatile write to<div class="fragment"><div class="line">V </div></div><!-- fragment --> is placed (in an implementation specific manner) in the global synchronization order. </li>
<li>
Consider an arbitrary thread<div class="fragment"><div class="line">T </div></div><!-- fragment --> (other than the current thread). If<div class="fragment"><div class="line">T </div></div><!-- fragment --> executes a synchronization action<div class="fragment"><div class="line">A </div></div><!-- fragment --> after the volatile write to<div class="fragment"><div class="line">V </div></div><!-- fragment --> (in the global synchronization order), it is therefore required to see either the current target of<div class="fragment"><div class="line">S </div></div><!-- fragment --> , or a later write to that target, if it executes a read on the target of<div class="fragment"><div class="line">S </div></div><!-- fragment --> . (This constraint is called "synchronization-order consistency".) </li>
<li>
The JMM specifically allows optimizing compilers to elide reads or writes of variables that are known to be useless. Such elided reads and writes have no effect on the happens-before relation. Regardless of this fact, the volatile<div class="fragment"><div class="line">V </div></div><!-- fragment --> will not be elided, even though its written value is indeterminate and its read value is not used. </li>
</ul>
<p>Because of the last point, the implementation behaves as if a volatile read of</p><div class="fragment"><div class="line">V </div></div><!-- fragment --><p> were performed by</p><div class="fragment"><div class="line">T </div></div><!-- fragment --><p> immediately after its action</p><div class="fragment"><div class="line">A </div></div><!-- fragment --><p> . In the local ordering of actions in</p><div class="fragment"><div class="line">T </div></div><!-- fragment --><p> , this read happens before any future read of the target of</p><div class="fragment"><div class="line">S </div></div><!-- fragment --><p> . It is as if the implementation arbitrarily picked a read of</p><div class="fragment"><div class="line">S </div></div><!-- fragment --><p> 's target by</p><div class="fragment"><div class="line">T </div></div><!-- fragment --><p> , and forced a read of</p><div class="fragment"><div class="line">V </div></div><!-- fragment --><p> to precede it, thereby ensuring communication of the new target value. </p>
<p>As long as the constraints of the Java Memory Model are obeyed, implementations may delay the completion of a</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> operation while other threads (</p><div class="fragment"><div class="line">T </div></div><!-- fragment --><p> above) continue to use previous values of</p><div class="fragment"><div class="line">S </div></div><!-- fragment --><p> 's target. However, implementations are (as always) encouraged to avoid livelock, and to eventually require all threads to take account of the updated target.</p>
<p><em>Discussion:</em> For performance reasons,</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> is not a virtual method on a single call site, but rather applies to a set of call sites. Some implementations may incur a large fixed overhead cost for processing one or more synchronization operations, but a small incremental cost for each additional call site. In any case, this operation is likely to be costly, since other threads may have to be somehow interrupted in order to make them notice the updated target value. However, it may be observed that a single call to synchronize several sites has the same formal effect as many calls, each on just one of the sites.</p>
<p><em>Implementation Note:</em> Simple implementations of</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#af60b01b063faeb6a52562aff92b9b5b2">MutableCallSite</a> </div></div><!-- fragment --><p> may use a volatile variable for the target of a mutable call site. In such an implementation, the</p><div class="fragment"><div class="line"><a class="code" href="classjava_1_1lang_1_1invoke_1_1_mutable_call_site.html#a691573d27e1e864b1d15f61a6a9a7f33">syncAll</a> </div></div><!-- fragment --><p> method can be a no-op, and yet it will conform to the JMM behavior documented above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sites</td><td>an array of call sites to be synchronized </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classjava_1_1lang_1_1_null_pointer_exception.html">NullPointerException</a></td><td>if the<div class="fragment"><div class="line">sites </div></div><!-- fragment --> array reference is null or the array contains a null </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_mutable_call_site_8java_source.html#l00274">274</a> of file <a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_cgraph.png" border="0" usemap="#classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_cgraph" alt=""/></div>
<map name="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_cgraph" id="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_cgraph">
<area shape="rect" id="node2" href="classjava_1_1util_1_1concurrent_1_1atomic_1_1_atomic_integer.html#a5546614d110cffeef3cc3fd5dc982e64" title="java.util.concurrent.atomic.\lAtomicInteger.lazySet" alt="" coords="216,5,393,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_icgraph.png" border="0" usemap="#classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_icgraph" alt=""/></div>
<map name="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_icgraph" id="classjava_1_1lang_1_1invoke_1_1_mutable_call_site_a691573d27e1e864b1d15f61a6a9a7f33_icgraph">
<area shape="rect" id="node2" href="classjava_1_1lang_1_1invoke_1_1_switch_point.html#a9e688bed3122c0dbbfe5e81691de2eb8" title="java.lang.invoke.SwitchPoint.invalidateAll" alt="" coords="216,13,473,39"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>E:/00_Code/openjdk8/java/lang/invoke/<a class="el" href="_mutable_call_site_8java_source.html">MutableCallSite.java</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
